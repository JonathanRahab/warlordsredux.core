<!DOCTYPE html>
<html lang="en">

<head>
    <style>
        html {
            visibility: hidden;
        }
    </style>
    <link rel="stylesheet" href="src\ui\style\vehicles.css">
    <link rel="stylesheet" href="src\ui\style\menu.css">
</head>

<body>
    <div class="menu-wrapper">
        <div class="menu-title">Vehicle Manager</div>
        <div class="vehicle-menu">
            <div class="panel"></div>
        </div>
    </div>
    <script src="src\ui\script\menu.js"></script>
    <script>
        function updateData(gameData) {
            gameData = JSON.parse(gameData || '{}');

            const panel = document.querySelector('.panel');
            panel.innerHTML = '';

            if (!gameData || !gameData.length) {
                panel.innerHTML = '<div>No vehicles belonging to player found. Buy vehicles using the buy menu.</div>';
                return;
            }

            gameData.forEach(vehicle => {
                const vehicleDiv = document.createElement('div');
                vehicleDiv.className = 'vehicle';
                vehicleDiv.dataset.vehicleId = vehicle[0];
                vehicleDiv.innerHTML = `<span class="vehicle-name">${vehicle[1]}</span>`;

                const vehicleOptions = vehicle[2];
                vehicleOptions.forEach(optionId => {
                    let optionClass = "";
                    let optionText = "";
                    if (optionId === 'remove') {
                        optionClass = 'remove-button';
                        optionText = 'REMOVE';
                    } else if (optionId === 'lock') {
                        optionClass = 'lock-button';
                        optionText = 'LOCK';
                    } else if (optionId === 'unlock') {
                        optionClass = 'unlock-button';
                        optionText = 'UNLOCK';
                    } else if (optionId === 'kick') {
                        optionClass = 'kick-button';
                        optionText = 'KICK ALL';
                    } else if (optionId === 'connect') {
                        optionClass = 'connect-button';
                        optionText = 'CONNECT';
                    } else if (optionId === 'rearm') {
                        optionClass = 'rearm-button';
                        optionText = 'REARM';
                    } else if (optionId === 'repair') {
                        optionClass = 'repair-button';
                        optionText = 'REPAIR';
                    } else if (optionId === 'refuel') {
                        optionClass = 'refuel-button';
                        optionText = 'REFUEL';
                    }

                    const button = document.createElement('button');
                    button.className = optionClass;
                    button.textContent = optionText;

                    button.addEventListener('mousedown', () => {
                        A3API.SendAlert(`["${vehicle[0]}", "${optionId}"]`);
                    });

                    vehicleDiv.appendChild(button);
                });

                panel.appendChild(vehicleDiv);
            });
        }
    </script>
    <script>
        var allStyles = document.getElementsByTagName("link");
        [...allStyles].forEach((link) => {
            if (link.href) {
                const styleNode = document.createElement("style");
                A3API.RequestFile(link.href).then(content => {
                    styleNode.innerHTML = content;
                    link.replaceWith(styleNode);
                });
            }
        });

        const allScripts = document.getElementsByTagName("script");
        [...allScripts].forEach((script) => {
            if (script.src) {
                A3API.RequestFile(script.src).then(content => {
                    const scriptNode = document.createElement("script");
                    scriptNode.innerHTML = content;
                    script.replaceWith(scriptNode);
                });
            }
        });
    </script>
</body>

</html>